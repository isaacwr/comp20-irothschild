<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=true">
    </script>

    <style type="text/css">
        html, body { height: 100%; margin: 0; padding: 0; }
        #map { height: 100%; }
    </style>
</head>
<body onload="initMap()">
    <div id="map"></div>
    <script type="text/javascript">

        var map;
        function initMap() {
            geo = navigator.geolocation;
            if(geo) {
                geo.getCurrentPosition(function(position) {
                    myPos = new google.maps.LatLng(position.coords.latitude,
                                                   position.coords.longitude);
                    map = new google.maps.Map(document.getElementById('map'), {
                        center: myPos,
                        zoom: 16
                    });
                    map.addListener("tilesloaded", function() {
                        var marker = new google.maps.Marker({
                            position: myPos,
                            title: "Username: CherylLytle" +
                                   ", Lattude: " + myPos.lat() + 
                                   ", Longitude: " + myPos.lng()
                        });
                        marker.setMap(map);
                        var infowindow = new google.maps.InfoWindow();
                        google.maps.event.addListener(marker, 'click', function() {
                            infowindow.setContent(marker.title);
                            infowindow.open(map, marker);
                        });
                        var xhr = new XMLHttpRequest();
                        var params = "login=CherylLytle"
                                     + "&lat=" + encodeURIComponent(myPos.lat())
                                     + "&lng=" + encodeURIComponent(myPos.lat())
                                     + "&message=" + encodeURIComponent("Let the good times roll");
                        xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                        xhr.send(params);
                    });
                });
            } else {
                alert("Geolocation is not supported by your web browser... :(");
            }

            var xhr = new XMLHttpRequest();
            var params = "login=CherylLytle"
                         + "&lat=" + encodeURIComponent(myPos.lat())
                         + "&lng=" + encodeURIComponent(myPos.lat())
                         + "&message=" + encodeURIComponent("Let the good times roll");
            xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            xhr.send(params);



        }
    </script>
</body>
</html>
